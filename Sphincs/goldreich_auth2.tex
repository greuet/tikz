%% Author: Aur√©lien Greuet (aureliengreuet@gmail.com)
%%
%% This work is licensed under the Creative Commons Attribution
%% Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).
%% To view a copy of this license, visit
%% https://creativecommons.org/licenses/by-sa/4.0/

\documentclass{article}



\usepackage[utf8]{inputenc}
\usepackage{tikz}

\usetikzlibrary{backgrounds,calc,shapes,shapes.symbols, fit,
  decorations.pathmorphing, decorations.pathreplacing, positioning}
\usepackage[graphics,tightpage,active]{preview}
\PreviewEnvironment{tikzpicture}


\tikzset{leaf/.style={draw = orange!50, fill = orange!50, nodes={rectangle}}}
\tikzset{leaftheone/.style={draw = orange, fill = orange, nodes={rectangle}}}
\tikzset{nodepub/.style={draw = green, fill = green, regular polygon,regular polygon sides=6}}
\tikzset{mynode/.style={draw = blue!50, fill = blue!50, circle}}
\tikzset{mynodetheone/.style={draw = blue, fill = blue, circle}}
\tikzset{pub/.style={fill = green!50, draw = green!50, inner sep = 2pt, rectangle, rounded corners}}


\begin{document}

\begin{tikzpicture}[yscale=-1,level/.style={sibling distance = 5cm/#1, level distance = 0.5cm}, 
  edge from parent path={(\tikzparentnode.north) -- ++(0,-0.08cm)-|(\tikzchildnode.south)}]
  \sffamily
  \node[pub] (public key){\tiny Public Key}
  child { node[mynode] {}
    child[sibling distance = 3cm] { node[mynode] {} 
      child[sibling distance = 1.5cm] { node[mynode] {}
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
        child[sibling distance = 0.75cm] { node[mynodetheone] {}
          child[sibling distance = 0.35cm] { node[nodepub] {}}
          child[sibling distance = 0.35cm] { node[leaftheone] {}
            child[level distance = 0.4cm] { node[leaftheone, inner sep = 1pt] {\tiny Msg}}
          }
        }
      }
      child[sibling distance = 1.5cm] { node[mynode] {}
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
      }
    }
    child[sibling distance = 3cm] { node[mynode] {} 
      child[sibling distance = 1.5cm] { node[mynode] {}
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
      }
      child[sibling distance = 1.5cm] { node[mynode] {}
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
        child[sibling distance = 0.75cm] { node[mynode] {}
          child[sibling distance = 0.35cm] { node[leaf] {}}
          child[sibling distance = 0.35cm] { node[leaf] {}}
        }
      }
    }
  };

  \node [right = 0.55cm of public key] {
    \scalebox{0.5}{
      \begin{tikzpicture}
        \node[leaf] (leaf) {};
        \node[right = 1pt of leaf] {\small OTS for msg};
        \node[mynode, below = 1.5pt of leaf] (mynode) {};
        \node[right = -0.5pt of mynode] {\small Hash + OTS for pk};
        \node[nodepub, below = 1.5pt of mynode] (nodepub) {};
        \node[right = -0.5pt of nodepub] {\small OTS pk};
      \end{tikzpicture}
    }
  };

\end{tikzpicture}
\end{document}
